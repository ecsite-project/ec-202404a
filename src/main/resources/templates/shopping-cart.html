<!DOCTYPE html>
<html lang="ja" xmlns:th="http://www.thymeleaf.org">
  <head
    th:replace="common/head :: head_fragment(title = 'カート', links = ~{::link})"
  >
    <link rel="stylesheet" th:href="@{/css/shopping-cart.css}" />
  </head>
  <body>
    <div th:replace="common/header :: header_fragment"></div>

    <h1>カート</h1>

    <span th:text="${noOrder}"></span>

    <div th:unless="${order == null}">
      <table>
        <thead>
          <tr>
            <th>商品名</th>
            <th>サイズ、価格（税抜き）、数量</th>
            <th>トッピング、価格（税抜き）</th>
            <th>小計</th>
            <th></th>
          </tr>
        </thead>
        <tbody>
          <tr th:each="orderItem: ${order.orderItemList}">
            <td th:text="${orderItem.item.name}"></td>
            <td th:if="${orderItem.size} == 'S'" th:text="'小盛り ' + ${#numbers.formatInteger(orderItem.item.priceS, 0, 'COMMA')} + '円 ' + ${orderItem.quantity} + '個'"></td>
            <td th:if="${orderItem.size} == 'M'" th:text="'並盛り ' + ${#numbers.formatInteger(orderItem.item.priceM, 0, 'COMMA')} + '円 ' + ${orderItem.quantity} + '個'"></td>
            <td th:if="${orderItem.size} == 'L'"  th:text="'大盛り ' + ${#numbers.formatInteger(orderItem.item.priceL, 0, 'COMMA')} + '円 ' + ${orderItem.quantity} + '個'"></td>
            <td>
              <ul th:each="orderTopping: ${orderItem.orderToppingList}">
                <li th:text="${orderTopping.topping.name} + ${#numbers.formatInteger(orderTopping.topping.price, 0, 'COMMA')} + '円'"></li>
              </ul>
            </td>
            <td th:text="${#numbers.formatInteger(orderItem.calcSubTotalPrice, 0, 'COMMA')} + '円'"></td>
            <td>
              <form action="shopping-cart.html" th:action="@{/shopping-cart/delete-item}" method="post">
                <input type="hidden" name="orderItemId" th:value="${orderItem.id}">
                <button>削除</button>
              </form>
            </td>
          </tr>
        </tbody>
      </table>

      <h4 th:text="'消費税：' + ${#numbers.formatInteger(order.tax, 0, 'COMMA')} + '円'"></h4>
      <h4 th:text="'ご注文金額合計：' + ${#numbers.formatInteger(order.calcTotalPrice + order.tax, 0, 'COMMA')} + '円（税込み）'"></h4>

      <form action="shopping-cart.html" th:action="@{/order-confirm}" method="get">
        <input type="hidden" name="orderId" th:value="${order.id}">
        <button>注文確認画面へ</button>
      </form>

    </div>

    <div th:replace="common/footer :: footer_fragment"></div>
  </body>
</html>
