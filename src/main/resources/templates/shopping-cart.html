<!DOCTYPE html>
<html lang="ja" xmlns:th="http://www.thymeleaf.org">
  <head
    th:replace="common/head :: head_fragment(title = 'カート', links = ~{::link})"
  >
    <link rel="stylesheet" th:href="@{/css/shopping-cart.css}" />
  </head>
  <body>
    <div th:replace="common/header :: header_fragment"></div>

    <h1 class="page-title">カート</h1>

    <span th:text="${noOrder}"></span>

    <div th:unless="${order == null}">
      <table class="cart-table">
        <thead class="cart-table__thead">
          <tr>
            <th>商品</th>
            <th class="th-quantity">数量</th>
            <th class="th-total">小計</th>
          </tr>
        </thead>
        <tbody>
          <tr th:each="orderItem: ${order.orderItemList}">
            <td class="td-item">
              <div class="td-item__img">
                <img th:src="@{'img/'} + ${orderItem.item.imagePath}" alt="" />
              </div>
              <div class="td-item__info">
                <p class="td-item__name" th:text="${orderItem.item.name}"></p>
                <p
                  class="td-item__price"
                  th:text="${#numbers.formatInteger(orderItem.calcSubTotalPrice / orderItem.quantity, 0, 'COMMA')} + '円 '"
                ></p>
                <p class="td-item__list">
                  <span
                    th:each="orderTopping : ${orderItem.orderToppingList}"
                    th:text="${orderTopping.topping.name}"
                  >
                  </span>
                </p>
              </div>
            </td>
            <td class="td-quantity">
              <p class="td-quantity__value" th:text="${orderItem.quantity}"></p>
              <div class="td-quantity__delete">
                <form
                  action="shopping-cart.html"
                  th:action="@{/shopping-cart/delete-item}"
                  method="post"
                >
                  <button class="waves-effect waves-lignt btn-flat">
                    削除
                  </button>
                </form>
              </div>
            </td>
            <td class="td-total">
              <p
                th:text="${#numbers.formatInteger(orderItem.calcSubTotalPrice, 0, 'COMMA')} + '円 '"
              ></p>
            </td>
          </tr>
        </tbody>
      </table>

      <h4
        th:text="'消費税：' + ${#numbers.formatInteger(order.tax, 0, 'COMMA')} + '円'"
      ></h4>
      <h4
        th:text="'ご注文金額合計：' + ${#numbers.formatInteger(order.calcTotalPrice + order.tax, 0, 'COMMA')} + '円（税込み）'"
      ></h4>

      <form
        action="shopping-cart.html"
        th:action="@{/order-confirm}"
        method="get"
      >
        <input type="hidden" name="orderId" th:value="${order.id}" />
        <button>注文確認画面へ</button>
      </form>
    </div>

    <div th:replace="common/footer :: footer_fragment"></div>
  </body>
</html>
